[gd_scene load_steps=33 format=3 uid="uid://0hfuqbytrpgo"]

[ext_resource type="Script" path="res://Scripts/World.gd" id="1_e3v7r"]
[ext_resource type="MeshLibrary" uid="uid://d00ge6jxao8rg" path="res://Art/Environment/MeshLibrary.tres" id="2_ggfdy"]
[ext_resource type="MeshLibrary" uid="uid://03lh43oktafn" path="res://Art/ShortWallMeshLibrary.tres" id="3_ixjjp"]
[ext_resource type="PackedScene" uid="uid://l7wxwtb8sjjg" path="res://Scenes/DraggableBox.tscn" id="4_34wsi"]
[ext_resource type="PackedScene" uid="uid://w4v1ajvmm7to" path="res://Scenes/camera_rig.tscn" id="7_6nc1r"]
[ext_resource type="PackedScene" uid="uid://chawhftcwjlwv" path="res://Scenes/player3D.tscn" id="8_53baf"]
[ext_resource type="PackedScene" uid="uid://bw8btg3rvl7hi" path="res://UI/UIController.tscn" id="10_ipnrv"]
[ext_resource type="Material" uid="uid://i4trcidoqn21" path="res://UI/Room1.tres" id="10_w3ono"]
[ext_resource type="Texture2D" uid="uid://cvfxc677xjqkr" path="res://UI/Space To Jump.png" id="11_dwymd"]
[ext_resource type="Texture2D" uid="uid://bwij7dng5hxuq" path="res://UI/E To Interact.png" id="12_3w3rf"]
[ext_resource type="Texture2D" uid="uid://vbtkia25bxh1" path="res://UI/Escape To Restart Level.png" id="13_1otub"]
[ext_resource type="PackedScene" uid="uid://sntsiehnprdd" path="res://Scenes/heart.tscn" id="14_kwevs"]
[ext_resource type="PackedScene" uid="uid://bn1bbpqcqcu34" path="res://Scenes/Scale.tscn" id="14_q72uw"]
[ext_resource type="PackedScene" uid="uid://dndj3h43iekxf" path="res://Scenes/npc.tscn" id="15_4lhjo"]
[ext_resource type="Script" path="res://Scripts/InteractableItem.gd" id="15_5fqo8"]
[ext_resource type="Material" uid="uid://bsm2v2h5iddf5" path="res://Art/Environment/Materials/door.tres" id="16_mu2yj"]
[ext_resource type="Script" path="res://addons/game_state_helper/game_state_helper.gd" id="17_h31vg"]

[sub_resource type="QuadMesh" id="QuadMesh_5spff"]

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_58wq8"]
data = PackedVector3Array(0.5, -0.5, 0, -0.5, -0.5, 0, 0.5, 0.5, 0, -0.5, -0.5, 0, -0.5, 0.5, 0, 0.5, 0.5, 0)

[sub_resource type="QuadMesh" id="QuadMesh_pn0c7"]
material = ExtResource("10_w3ono")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_46irt"]
transparency = 1
albedo_texture = ExtResource("11_dwymd")
emission_enabled = true
emission = Color(1, 1, 1, 1)
texture_filter = 0

[sub_resource type="QuadMesh" id="QuadMesh_wqihi"]
material = SubResource("StandardMaterial3D_46irt")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_lh65c"]
transparency = 1
albedo_texture = ExtResource("12_3w3rf")
emission_enabled = true
emission = Color(1, 1, 1, 1)
texture_filter = 0

[sub_resource type="QuadMesh" id="QuadMesh_qb13h"]
material = SubResource("StandardMaterial3D_lh65c")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_4xq0t"]
transparency = 1
albedo_texture = ExtResource("13_1otub")
emission_enabled = true
emission = Color(1, 1, 1, 1)
texture_filter = 0
texture_repeat = false

[sub_resource type="QuadMesh" id="QuadMesh_pjnjc"]
material = SubResource("StandardMaterial3D_4xq0t")

[sub_resource type="BoxShape3D" id="BoxShape3D_m0v11"]
size = Vector3(1, 0.653704, 1)

[sub_resource type="ArrayMesh" id="ArrayMesh_qddc0"]
_surfaces = [{
"aabb": AABB(-0.166421, -2.98023e-08, -0.011612, 0.332853, 0.687803, 9.99961e-06),
"format": 4097,
"index_count": 6,
"index_data": PackedByteArray(0, 0, 2, 0, 1, 0, 2, 0, 0, 0, 3, 0),
"name": "door",
"primitive": 3,
"vertex_count": 4,
"vertex_data": PackedByteArray(96, 106, 42, 62, 0, 0, 0, 179, 96, 64, 62, 188, 96, 106, 42, 62, 223, 19, 48, 63, 96, 64, 62, 188, 96, 106, 42, 190, 223, 19, 48, 63, 96, 64, 62, 188, 96, 106, 42, 190, 0, 0, 0, 179, 96, 64, 62, 188)
}]
blend_shape_mode = 0

[sub_resource type="ArrayMesh" id="ArrayMesh_a83h3"]
resource_local_to_scene = true
resource_name = "Root Scene_prop_Door"
_surfaces = [{
"aabb": AABB(-0.166421, -2.98023e-08, -0.011612, 0.332853, 0.687803, 9.99961e-06),
"attribute_data": PackedByteArray(109, 178, 127, 63, 0, 0, 128, 63, 109, 178, 127, 63, 0, 0, 0, 0, 0, 38, 155, 58, 0, 0, 0, 0, 0, 38, 155, 58, 0, 0, 128, 63),
"format": 4119,
"index_count": 6,
"index_data": PackedByteArray(0, 0, 2, 0, 1, 0, 2, 0, 0, 0, 3, 0),
"material": ExtResource("16_mu2yj"),
"name": "door",
"primitive": 3,
"vertex_count": 4,
"vertex_data": PackedByteArray(96, 106, 42, 62, 0, 0, 0, 179, 96, 64, 62, 188, 255, 127, 255, 127, 255, 255, 255, 191, 96, 106, 42, 62, 223, 19, 48, 63, 96, 64, 62, 188, 255, 127, 255, 127, 255, 255, 255, 191, 96, 106, 42, 190, 223, 19, 48, 63, 96, 64, 62, 188, 255, 127, 255, 127, 255, 255, 255, 191, 96, 106, 42, 190, 0, 0, 0, 179, 96, 64, 62, 188, 255, 127, 255, 127, 255, 255, 255, 191)
}]
blend_shape_mode = 0
shadow_mesh = SubResource("ArrayMesh_qddc0")

[sub_resource type="ConcavePolygonShape3D" id="ConcavePolygonShape3D_r8klp"]
data = PackedVector3Array(0.1664, 0, -0.0116, -0.1664, 0.6878, -0.0116, 0.1664, 0.6878, -0.0116, -0.1664, 0.6878, -0.0116, 0.1664, 0, -0.0116, -0.1664, 0, -0.0116)

[sub_resource type="Animation" id="Animation_gersx"]
length = 0.001

[sub_resource type="AnimationLibrary" id="AnimationLibrary_cja32"]
_data = {
"RESET": SubResource("Animation_gersx")
}

[node name="Room" type="Node3D"]
transform = Transform3D(1, -5.49965e-05, 4.14818e-05, 5.49965e-05, 1, -1.13368e-05, -4.14818e-05, 1.13368e-05, 1, 0, 0, 0)
script = ExtResource("1_e3v7r")

[node name="GridMap" type="GridMap" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.25, 0, 0.25)
mesh_library = ExtResource("2_ggfdy")
cell_size = Vector3(1, 1, 1)
data = {
"cells": PackedInt32Array(4, 0, 655360, 5, 0, 655360, 6, 0, 655360, 4, 1, 655360, 5, 1, 655360, 6, 1, 655360, 4, 2, 655360, 5, 2, 655360, 6, 2, 655360, 5, 65534, 1, 3, 65534, 2, 7, 65534, 1441794, 4, 65534, 2, 7, 3, 655362, 3, 3, 1048578, 3, 65535, 2, 3, 0, 1048580, 3, 2, 1048580, 3, 1, 1048580, 4, 3, 0, 5, 3, 0, 6, 3, 655364, 7, 2, 1441796, 7, 1, 1441796, 7, 0, 1441796, 7, 65535, 1441796, 4, 65535, 1441792, 5, 65535, 1441792, 6, 65535, 1441792, 6, 65534, 4, 65543, 65534, 1441799, 65543, 65535, 1441799, 65543, 0, 1441799, 65543, 1, 1441799, 65543, 2, 1441799, 65543, 3, 1441799, 65538, 1, 1441799, 65538, 2, 1441799, 65538, 0, 1441799, 65538, 3, 1441800, 65539, 65534, 2, 65539, 65535, 1048583, 65540, 4, 1179652, 65541, 4, 1179648, 7, 5, 1310720, 7, 4, 1310720, 4, 4, 7, 5, 4, 1, 5, 5, 0, 4, 5, 1441799, 4, 6, 1441799, 6, 5, 1048583, 6, 4, 1048583, 5, 6, 1441796, 5, 7, 1441796, 5, 8, 1441796, 5, 9, 1441796, 4, 7, 1441799, 4, 8, 1441799, 4, 9, 1441799, 5, 10, 655364, 6, 10, 1048583, 5, 11, 7, 4, 10, 1441799, 65540, 65534, 7, 65541, 65534, 7, 65542, 65534, 7, 65543, 65533, 655367)
}
metadata/_editor_floor_ = Vector3(0, 1, 0)

[node name="GridMap2" type="GridMap" parent="."]
transform = Transform3D(1, -9.64521e-13, 0, -1.06619e-12, 1, 0, 0, 0, 1, 0.25, -7.29897e-13, 0.25)
mesh_library = ExtResource("3_ixjjp")
cell_size = Vector3(1, 0.333, 1)
data = {
"cells": PackedInt32Array(262165, 65535, 655361)
}
metadata/_editor_floor_ = Vector3(0, 9, 0)

[node name="Environment" type="Node3D" parent="."]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, 0, 0, 0)

[node name="OmniLight3D" type="OmniLight3D" parent="Environment"]
transform = Transform3D(1, 4.68335e-10, 6.22094e-10, -1.0662e-12, 1, 2.28101e-09, 0, 0, 1, 5.95957, 2.16056, 0.26713)
light_color = Color(0.654902, 0.784314, 0.427451, 1)
light_energy = 0.8
light_volumetric_fog_energy = 0.6
shadow_enabled = true
distance_fade_enabled = true

[node name="Box5" parent="Environment" instance=ExtResource("4_34wsi")]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, 3.49996, 0.664984, -0.499977)
skeleton = NodePath("../..")

[node name="Box7" parent="Environment" instance=ExtResource("4_34wsi")]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, 3.49998, 0.998001, -0.499987)
skeleton = NodePath("../..")

[node name="Box6" parent="Environment" instance=ExtResource("4_34wsi")]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, 4.99988, 0.666924, 0.50008)
skeleton = NodePath("../..")

[node name="Floor" type="MeshInstance3D" parent="Environment"]
transform = Transform3D(94.1028, -0.000620166, 9.65473e-05, -0.00907888, 3.59042e-06, 1.00071, -0.00127177, -45.8884, 8.15407e-08, 3.24997, 0.5, 4.75001)
visible = false
mesh = SubResource("QuadMesh_5spff")
skeleton = NodePath("../..")

[node name="StaticBody3D" type="StaticBody3D" parent="Environment/Floor"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Environment/Floor/StaticBody3D"]
transform = Transform3D(1, -3.63798e-12, 6.40182e-14, 0, 1, -5.68434e-14, 2.73941e-11, 0, 1, 0, 0, 0)
shape = SubResource("ConcavePolygonShape3D_58wq8")

[node name="CanvasLayer" parent="." instance=ExtResource("10_ipnrv")]

[node name="CameraRig" parent="." instance=ExtResource("7_6nc1r")]

[node name="Player" parent="." instance=ExtResource("8_53baf")]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, 5.67626, 0.775434, 10.3132)

[node name="Floating UI" type="Node3D" parent="."]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, 5.70162, 0.859921, 9.52243)

[node name="MeshInstance3D" type="MeshInstance3D" parent="Floating UI"]
transform = Transform3D(0.763602, -1.30687e-13, -4.00178e-11, -4.26676e-11, 0.218821, -1.00044e-11, 0, -3.86535e-12, 1.32259, 0.0712738, 0.232334, 0.418613)
mesh = SubResource("QuadMesh_pn0c7")

[node name="Floating UI2" type="Node3D" parent="."]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, 5.70162, 0.859921, 8.70099)

[node name="MeshInstance3D" type="MeshInstance3D" parent="Floating UI2"]
transform = Transform3D(0.763602, -1.30729e-13, -2.54659e-11, -2.81157e-11, 0.218821, -6.36646e-12, 0, -2.95586e-12, 1.32259, 0.0712743, 0.232334, 0.196579)
mesh = SubResource("QuadMesh_wqihi")

[node name="Floating UI3" type="Node3D" parent="."]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, 5.70162, 0.859921, 7.49188)

[node name="MeshInstance3D" type="MeshInstance3D" parent="Floating UI3"]
transform = Transform3D(0.763602, -1.30729e-13, -2.54659e-11, -2.81157e-11, 0.218821, -6.36646e-12, 0, -2.95586e-12, 1.32259, 0.0712743, 0.232334, 0.196579)
mesh = SubResource("QuadMesh_qb13h")

[node name="Floating UI4" type="Node3D" parent="."]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, 5.70162, 0.859921, 5.34556)

[node name="MeshInstance3D" type="MeshInstance3D" parent="Floating UI4"]
transform = Transform3D(0.832499, -5.60577e-12, -3.63798e-11, -2.41431e-11, 0.278814, -9.09495e-12, -1.45519e-11, -4.54747e-12, 1.32259, 0.0712752, 0.228998, 0.196579)
mesh = SubResource("QuadMesh_pjnjc")

[node name="Scale" parent="." instance=ExtResource("14_q72uw")]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, 6.73489, 0.752318, -1.60029)

[node name="Heart" parent="." instance=ExtResource("14_kwevs")]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, 3.74037, 1.56176, -1.12855)

[node name="NPC" parent="." instance=ExtResource("15_4lhjo")]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, 5.79633, 0.621448, 2.95328)

[node name="SceneTransitionDoor" type="Node3D" parent="." node_paths=PackedStringArray("required_alter") groups=["scene_transition_door"]]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, 5.75, 0.619596, -1.75)
script = ExtResource("15_5fqo8")
type = 6
required_alter = NodePath("../Scale")
destination_scene = "res://Scenes/Rooms/Room2.tscn"

[node name="InteractionArea" type="Area3D" parent="SceneTransitionDoor"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.165, 0)
collision_layer = 16
collision_mask = 128

[node name="CollisionShape3D" type="CollisionShape3D" parent="SceneTransitionDoor/InteractionArea"]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, 0, 0.154041, 0)
shape = SubResource("BoxShape3D_m0v11")

[node name="MeshInstance3D" type="MeshInstance3D" parent="SceneTransitionDoor"]
transform = Transform3D(1, -9.64506e-13, 0, -1.0662e-12, 1, 0, 0, 0, 1, -1.43051e-06, -0.120232, 0)
mesh = SubResource("ArrayMesh_a83h3")

[node name="StaticBody3D" type="StaticBody3D" parent="SceneTransitionDoor/MeshInstance3D"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="SceneTransitionDoor/MeshInstance3D/StaticBody3D"]
shape = SubResource("ConcavePolygonShape3D_r8klp")

[node name="GameStateHelper" type="Node" parent="SceneTransitionDoor"]
script = ExtResource("17_h31vg")
save_properties = Array[String](["_toggled_on", "dialog_triggered", "saved", "broken", "trans_door_can_open"])

[node name="PlayerSpawnPoint" type="Node3D" parent="SceneTransitionDoor"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.1, 0.219)

[node name="AnimationPlayer" type="AnimationPlayer" parent="SceneTransitionDoor"]
libraries = {
"": SubResource("AnimationLibrary_cja32")
}

[connection signal="loading_data" from="SceneTransitionDoor/GameStateHelper" to="SceneTransitionDoor" method="_on_game_state_helper_loading_data" flags=18]

[editable path="CanvasLayer"]
